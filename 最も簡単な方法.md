# 最も簡単な解決方法

## ⚠️ 重要: まずデータベースを設定してください

**「DATABASE_URL環境変数が見つからない」というエラーが出ている場合**は、まずデータベースを設定する必要があります。

→ **`データベース設定方法.md`** を参照してください。

---

## 問題
「Add Hours」ボタンを押すと「User not found」エラーが出る

## 解決方法（2つの選択肢）

---

## 方法1: Prisma Studioで手動でユーザーを作成（最も簡単）

### 手順

1. **ターミナルを開く**
   - Mac: アプリケーション > ユーティリティ > ターミナル
   - Windows: コマンドプロンプトまたはPowerShell

2. **プロジェクトフォルダに移動**
   ```bash
   cd /Users/nctakahiroyoda/Documents/programs/MXVA
   ```

3. **Prisma Studioを起動**
   ```bash
   npx prisma studio
   ```
   
   ブラウザが自動的に開きます（http://localhost:5555）

4. **Userテーブルをクリック**

5. **「Add record」ボタンをクリック**

6. **以下の情報を入力**
   - `email`: **Firebase認証で使っているメールアドレス**（重要！）
   - `infiniteFlightUsername`: 適当なユーザー名（例: `testuser`）
   - `passwordHash`: 適当な文字列（例: `$2a$10$placeholder12345678901234567890`）
   - `role`: `user` と入力
   - その他の項目は空欄でOK

7. **「Save 1 change」ボタンをクリック**

8. **完了！**

これで「Add Hours」ボタンが動くようになります。

---

## 方法2: スクリプトで自動同期（少し複雑）

もしFirebase認証のユーザーが複数いる場合は、この方法が便利です。

### 必要な準備

1. **firebase-adminをインストール**
   ```bash
   npm install firebase-admin
   ```

2. **Firebaseの設定ファイルを取得**
   - https://console.firebase.google.com/ を開く
   - プロジェクトを選択
   - プロジェクト設定 > サービスアカウント
   - 「新しい秘密鍵の生成」をクリック
   - JSONファイルをダウンロード

3. **環境変数を設定**
   - ダウンロードしたJSONファイルを開く
   - 中身をすべてコピー
   - プロジェクトフォルダに `.env.local` ファイルを作成
   - 以下のように追加：
     ```
     FIREBASE_SERVICE_ACCOUNT_KEY='[コピーしたJSONの内容]'
     ```
   - **重要**: JSON全体をシングルクォート（'）で囲む

4. **スクリプトを実行**
   ```bash
   node scripts/sync-firebase-to-prisma.js
   ```

---

## どちらを選ぶべき？

- **ユーザーが1人だけ**: 方法1（Prisma Studio）が簡単
- **ユーザーが複数いる**: 方法2（スクリプト）が便利

---

## よくある質問

### Q: Prisma Studioが開かない
A: ターミナルでエラーメッセージを確認してください。データベース接続の問題かもしれません。

### Q: 「Add record」ボタンが見つからない
A: Userテーブルをクリックした後、右上に「Add record」ボタンがあります。

### Q: emailはどこで確認できる？
A: Firebase Console > Authentication > Users で確認できます。

### Q: まだエラーが出る
A: 入力したemailが、Firebase認証で使っているemailと完全に一致しているか確認してください。

